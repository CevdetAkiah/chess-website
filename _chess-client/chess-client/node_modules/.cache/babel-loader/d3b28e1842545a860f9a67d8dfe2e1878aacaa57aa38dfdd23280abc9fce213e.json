{"ast":null,"code":"var _jsxFileName = \"/home/cevdet/go-projects/react-chess/chess-app/src/pages/Game/index.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useContext } from 'react';\nimport { Chess } from 'chess.js';\nimport { createBoard } from '../../functions/create-board';\nimport Board from '../../components/board';\nimport { GameContext } from '../../context/GameContext';\nimport { types } from '../../context/actions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FEN = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1';\nconst Game = () => {\n  _s();\n  const [fen, setFen] = useState(FEN);\n  const {\n    current: chess\n  } = useRef(new Chess(fen));\n  const [board, setBoard] = useState(createBoard(fen));\n\n  // every time a change is made to the state of the game, the board is updated with the new fen\n  useEffect(() => {\n    setBoard(createBoard(fen));\n  }, [fen]);\n  const {\n    possibleMoves,\n    dispatch\n  } = useContext(GameContext);\n\n  // will detect if a player is in check\n  useEffect(() => {\n    dispatch({\n      type: types.SET_TURN,\n      player: chess.turn(),\n      check: chess.isCheck()\n    });\n  }, [fen, dispatch, chess]);\n\n  /** move handling */\n  const fromPos = useRef(); /** follow setFromPos to the piece component */\n\n  // share move set with components\n\n  const makeMove = pos => {\n    const from = fromPos.current;\n    const to = pos;\n    const validMove = possibleMoves.includes(to);\n    console.log(to);\n    // console.log(possibleMoves)\n    if (validMove) {\n      chess.move({\n        from,\n        to\n      });\n    }\n    dispatch({\n      type: types.CLEAR_POSSIBLE_MOVES\n    }); // unhighlight possible moves\n    setFen(chess.fen()); // update the fen with the new move/piece positions\n  };\n\n  // this is called once a piece is dragged\n  const setFromPos = pos => {\n    fromPos.current = pos;\n    dispatch({\n      type: types.SET_POSSIBLE_MOVES,\n      moves: chess.moves({\n        square: pos\n      }) // send the possible moves from the currently selected position to highlight\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"game\",\n    children: /*#__PURE__*/_jsxDEV(Board, {\n      cells: board,\n      makeMove: makeMove,\n      setFromPos: setFromPos\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 12\n  }, this);\n};\n_s(Game, \"kiTSTIrOKSEMVpSaK7d7vLed5Ds=\");\n_c = Game;\nexport default Game;\nvar _c;\n$RefreshReg$(_c, \"Game\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useContext","Chess","createBoard","Board","GameContext","types","jsxDEV","_jsxDEV","FEN","Game","_s","fen","setFen","current","chess","board","setBoard","possibleMoves","dispatch","type","SET_TURN","player","turn","check","isCheck","fromPos","makeMove","pos","from","to","validMove","includes","console","log","move","CLEAR_POSSIBLE_MOVES","setFromPos","SET_POSSIBLE_MOVES","moves","square","className","children","cells","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/cevdet/go-projects/react-chess/chess-app/src/pages/Game/index.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useContext} from 'react';\nimport {Chess} from 'chess.js';\nimport { createBoard } from '../../functions/create-board';\nimport Board from  '../../components/board';\nimport { GameContext } from '../../context/GameContext';\nimport { types } from '../../context/actions';\n\nconst FEN = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1';\nconst Game = ()=> {\n    const[fen, setFen] = useState(FEN);\n    const {current: chess} = useRef(new Chess(fen));\n    const [board,setBoard] = useState(createBoard(fen));\n\n    // every time a change is made to the state of the game, the board is updated with the new fen\n    useEffect(() =>{\n        setBoard(createBoard(fen));\n    }, [fen]);\n\n    const { possibleMoves, dispatch } = useContext(GameContext);\n\n    // will detect if a player is in check\n    useEffect(() =>{\n        dispatch({\n            type: types.SET_TURN,\n            player: chess.turn(),\n            check: chess.isCheck(),\n        });\n    }, [fen, dispatch, chess]);\n\n    /** move handling */\n    const fromPos = useRef(); /** follow setFromPos to the piece component */\n\n    // share move set with components\n    \n\n    const makeMove = (pos) =>{\n        const from = fromPos.current;\n        const to = pos;\n        const validMove = possibleMoves.includes(to)\n        console.log(to)\n        // console.log(possibleMoves)\n        if (validMove){\n            chess.move({ from, to });\n        }\n        dispatch({ type: types.CLEAR_POSSIBLE_MOVES}) // unhighlight possible moves\n        setFen(chess.fen()); // update the fen with the new move/piece positions\n    };\n\n    // this is called once a piece is dragged\n    const setFromPos = (pos) => {\n        fromPos.current = pos\n        dispatch({\n            type:types.SET_POSSIBLE_MOVES,\n            moves: chess.moves({ square: pos }) // send the possible moves from the currently selected position to highlight\n        })\n    }\n\n\n\n    return <div className=\"game\">\n        <Board cells = {board} makeMove={makeMove} setFromPos={setFromPos}/>\n    </div>\n}\n\nexport default Game;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}